{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import React, {useEffect, useState } from 'react';\n\nconst CONFIGLY_SERVER_URL = \"http://configly.herokuapp.com/api/v1/value\";\nconst CONFIGLY_API_KEY = 'yikes';\n\ninterface props {\n    prop: string,\n    render: (value: string) => void,\n}\n\nfunction loadConfiglyData(key: string, onComplete: (data: string) => any) {\n    fetch(`${CONFIGLY_SERVER_URL}?keys[]=${key}&apiKey=${CONFIGLY_API_KEY}`, {method: 'GET'})\n      .then(res => res.json())\n      .then((result) => onComplete(result.data[key].value), (error) => {console.log(error)});\n}\n\nfunction BaseConfiglyComponent(props: props, renderFunction: (data: string | null) => void) {\n    const [value, setValue] = useState(null);\n    const [requestInProgress, setRequestInProgress] = useState(false);\n\n    useEffect(() => {\n        if (!requestInProgress && !value) {\n            loadConfiglyData(props.prop, (value: any) => {setValue(value); setRequestInProgress(false);});\n            setRequestInProgress(true);\n        }\n    }, [requestInProgress, value, props.prop]);\n\n    if (value === null) {\n        return(<span>Loading...</span>);\n    } else { \n        return(renderFunction(value));\n    }\n}\n\nfunction ConfiglyComponent(props: props) {\n    const { render } = props;\n    return BaseConfiglyComponent(props, (value: string) => render(value));\n}\n\nfunction ConfiglyText(props: props) {\n    return BaseConfiglyComponent(props, (value: string) => {return(<span>{value}</span>)});\n}\n\nfunction ConfiglyDropdown(props: props) {\n    return BaseConfiglyComponent(props, (value: string) => {\n        const options = Object.keys(value).map((key) =>\n            <option value={key}>{value[key]}</option>\n        );\n\n        return (<select>\n           {options}         \n        </select>);\n    })\n}\n\nexport {ConfiglyText, ConfiglyDropdown, ConfiglyComponent as default};"],"names":["useState","useEffect","React"],"mappings":";;;;;;;;AAEA,IAAM,mBAAmB,GAAG,4CAA4C,CAAC;AACzE,IAAM,gBAAgB,GAAG,OAAO,CAAC;AAOjC,SAAS,gBAAgB,CAAC,GAAW,EAAE,UAAiC;IACpE,KAAK,CAAI,mBAAmB,gBAAW,GAAG,gBAAW,gBAAkB,EAAE,EAAC,MAAM,EAAE,KAAK,EAAC,CAAC;SACtF,IAAI,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,IAAI,EAAE,GAAA,CAAC;SACvB,IAAI,CAAC,UAAC,MAAM,IAAK,OAAA,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAA,EAAE,UAAC,KAAK,IAAM,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA,EAAC,CAAC,CAAC;AAC7F,CAAC;AAED,SAAS,qBAAqB,CAAC,KAAY,EAAE,cAA6C;IAChF,IAAA,KAAoBA,cAAQ,CAAC,IAAI,CAAC,EAAjC,KAAK,QAAA,EAAE,QAAQ,QAAkB,CAAC;IACnC,IAAA,KAA4CA,cAAQ,CAAC,KAAK,CAAC,EAA1D,iBAAiB,QAAA,EAAE,oBAAoB,QAAmB,CAAC;IAElEC,eAAS,CAAC;QACN,IAAI,CAAC,iBAAiB,IAAI,CAAC,KAAK,EAAE;YAC9B,gBAAgB,CAAC,KAAK,CAAC,IAAI,EAAE,UAAC,KAAU,IAAM,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC;YAC9F,oBAAoB,CAAC,IAAI,CAAC,CAAC;SAC9B;KACJ,EAAE,CAAC,iBAAiB,EAAE,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;IAE3C,IAAI,KAAK,KAAK,IAAI,EAAE;QAChB,QAAOC,mEAAuB,EAAE;KACnC;SAAM;QACH,QAAO,cAAc,CAAC,KAAK,CAAC,EAAE;KACjC;AACL,CAAC;AAED,SAAS,iBAAiB,CAAC,KAAY;IAC3B,IAAA,MAAM,GAAK,KAAK,OAAV,CAAW;IACzB,OAAO,qBAAqB,CAAC,KAAK,EAAE,UAAC,KAAa,IAAK,OAAA,MAAM,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;AAC1E,CAAC;AAED,SAAS,YAAY,CAAC,KAAY;IAC9B,OAAO,qBAAqB,CAAC,KAAK,EAAE,UAAC,KAAa,IAAM,QAAOA,sDAAO,KAAK,CAAQ,EAAC,EAAC,CAAC,CAAC;AAC3F,CAAC;AAED,SAAS,gBAAgB,CAAC,KAAY;IAClC,OAAO,qBAAqB,CAAC,KAAK,EAAE,UAAC,KAAa;QAC9C,IAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,UAAC,GAAG;YACvC,OAAAA,oDAAQ,KAAK,EAAE,GAAG,IAAG,KAAK,CAAC,GAAG,CAAC,CAAU;SAAA,CAC5C,CAAC;QAEF,QAAQA,wDACJ,OAAO,CACF,EAAE;KACd,CAAC,CAAA;AACN;;;;;;"}